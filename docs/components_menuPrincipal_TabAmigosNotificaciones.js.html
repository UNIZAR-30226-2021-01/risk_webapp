<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/menuPrincipal/TabAmigosNotificaciones.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/menuPrincipal/TabAmigosNotificaciones.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useState, useEffect, useContext } from 'react'
import AuthApi from 'utils/AuthApi'
import constants from 'utils/constants'
import ListaAmigos from './../panelAmigos/ListaAmigos'
import ListaNotificaciones from './../panelNotificaciones/ListaNotificaciones'
import EliminarAmigo from './../panelAmigos/EliminarAmigo'
import { obtenerAmigos, obtenerNotificaciones } from 'utils/restAPI'
import { obtenerCredenciales } from 'utils/usuarioVO'
import './tabAmigosNotificaciones.css'
import {
	MDBContainer,
	MDBTabPane,
	MDBTabContent,
	MDBNav,
	MDBNavItem,
	MDBNavLink,
	MDBBadge,
} from 'mdbreact'

/**
 *
 * @returns Componente que representa una tabla en la que el usuario podrá
 * consultar tanto la lista de sus amigos como las notificaciones que haya
 * recibido
 */
export const TabAmigosNotificaciones = () => {
	const Auth = useContext(AuthApi)

	const [amigos, setAmigos] = useState([])

	// Panel activo
	const [active, setActive] = useState({ justified: '1' })

	// Número de notificaciones, se actualizará conforme lleguen y se borren
	const [notis, setNotis] = useState([])

	const fetchAmigos = async () => {
		//console.log('Petición de amigos')
		const nuestraInfo = obtenerCredenciales(Auth)
		const dataAmigos = await obtenerAmigos(nuestraInfo)
		//console.log(dataAmigos)
		setAmigos(dataAmigos.amigos)
	}

	const fetchNotis = async () => {
		//console.log('Petición de notificaciones')
		const nuestraInfo = obtenerCredenciales(Auth)
		const dataNotis = await obtenerNotificaciones(nuestraInfo)
		//console.log(dataNotis)

		// DATOS DE PRUEBA
		/*let notisPrueba = [{infoExtra: 'PacoGamer', idEnvio: 69}, 
		{infoExtra: 'Raulito69HD', idEnvio: 15},
		{infoExtra: 'Raulito69XX', idEnvio: 12},
		{infoExtra: 'Raulito69', idEnvio: 144}]
		setNotis(notisPrueba)*/
		setNotis(dataNotis.notificaciones)
	}

	useEffect(() => {
		const interval = setInterval(async () => {
			fetchAmigos()
			fetchNotis()
		}, constants.REFRESH_TIME)
		return () => clearInterval(interval) //Elimina la ejecución periódica al desmontar
	}, [])

	const togglePills = (type, tab) => (e) => {
		e.preventDefault()
		if (active.justified !== tab) {
			let items = { ...active }
			items[type] = tab
			setActive(items)
		}
	}

	return (
		&lt;MDBContainer className="border mt-4 contenedor-pills">
			&lt;MDBNav className="nav-pills nav-justified ">
				&lt;MDBNavItem className="my-2">
					&lt;MDBNavLink
						link
						to="#"
						active={active.justified === '1'}
						onClick={togglePills('justified', '1')}
					>
						Lista de amigos
					&lt;/MDBNavLink>
				&lt;/MDBNavItem>
				&lt;MDBNavItem className="my-2">
					&lt;MDBNavLink
						link
						to="#"
						active={active.justified === '2'}
						onClick={togglePills('justified', '2')}
					>
						Notificaciones{' '}
						{notis.length > 0 &amp;&amp; (
							&lt;MDBBadge color="danger" pill>
								{' '}
								{notis.length}{' '}
							&lt;/MDBBadge>
						)}
					&lt;/MDBNavLink>
				&lt;/MDBNavItem>
			&lt;/MDBNav>
			&lt;MDBTabContent activeItem={active.justified}>
				&lt;MDBTabPane tabId="1">
					&lt;ListaAmigos usuarios={amigos} elemento={&lt;EliminarAmigo />} />
				&lt;/MDBTabPane>
				&lt;MDBTabPane tabId="2">
					&lt;ListaNotificaciones notificaciones={notis} />
				&lt;/MDBTabPane>
			&lt;/MDBTabContent>
		&lt;/MDBContainer>
	)
}

export default TabAmigosNotificaciones
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module.exports.html">exports</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ActualizacionConfiguracion">ActualizacionConfiguracion</a></li><li><a href="global.html#Amigo">Amigo</a></li><li><a href="global.html#AnyadirAmigo">AnyadirAmigo</a></li><li><a href="global.html#App">App</a></li><li><a href="global.html#AuthApi">AuthApi</a></li><li><a href="global.html#Button">Button</a></li><li><a href="global.html#constants">constants</a></li><li><a href="global.html#CrearSala">CrearSala</a></li><li><a href="global.html#credenciales">credenciales</a></li><li><a href="global.html#EliminarAmigo">EliminarAmigo</a></li><li><a href="global.html#EntradaAmigo">EntradaAmigo</a></li><li><a href="global.html#EntradaCambioClave">EntradaCambioClave</a></li><li><a href="global.html#EntradaClave">EntradaClave</a></li><li><a href="global.html#EntradaCorreo">EntradaCorreo</a></li><li><a href="global.html#EntradaImg">EntradaImg</a></li><li><a href="global.html#EntradaNombre">EntradaNombre</a></li><li><a href="global.html#EntradaOcultaHash">EntradaOcultaHash</a></li><li><a href="global.html#EntradaOcultaId">EntradaOcultaId</a></li><li><a href="global.html#EntradaUsuario">EntradaUsuario</a></li><li><a href="global.html#ErroresCampo">ErroresCampo</a></li><li><a href="global.html#ErroresServer">ErroresServer</a></li><li><a href="global.html#Footer">Footer</a></li><li><a href="global.html#FormActualizar">FormActualizar</a></li><li><a href="global.html#FormInicio">FormInicio</a></li><li><a href="global.html#FormRegistro">FormRegistro</a></li><li><a href="global.html#Head">Head</a></li><li><a href="global.html#Header">Header</a></li><li><a href="global.html#InicioSesion">InicioSesion</a></li><li><a href="global.html#inicioSesion">inicioSesion</a></li><li><a href="global.html#ListaAmigos">ListaAmigos</a></li><li><a href="global.html#ListaNotificaciones">ListaNotificaciones</a></li><li><a href="global.html#ListaPartidas">ListaPartidas</a></li><li><a href="global.html#logOut">logOut</a></li><li><a href="global.html#MenuOpts">MenuOpts</a></li><li><a href="global.html#MenuPrincipal">MenuPrincipal</a></li><li><a href="global.html#NotificacionAmistad">NotificacionAmistad</a></li><li><a href="global.html#obtenerAspectosDisponibles">obtenerAspectosDisponibles</a></li><li><a href="global.html#obtenerAspectosTienda">obtenerAspectosTienda</a></li><li><a href="global.html#obtenerCredenciales">obtenerCredenciales</a></li><li><a href="global.html#obtenerDir">obtenerDir</a></li><li><a href="global.html#obtenerIconosDisponibles">obtenerIconosDisponibles</a></li><li><a href="global.html#obtenerIconosTienda">obtenerIconosTienda</a></li><li><a href="global.html#obtenerPrevio">obtenerPrevio</a></li><li><a href="global.html#obtenerRutaAspecto">obtenerRutaAspecto</a></li><li><a href="global.html#obtenerRutaIcono">obtenerRutaIcono</a></li><li><a href="global.html#obtenerSiguiente">obtenerSiguiente</a></li><li><a href="global.html#OkServer">OkServer</a></li><li><a href="global.html#PartidaMini">PartidaMini</a></li><li><a href="global.html#peticionQForm">peticionQForm</a></li><li><a href="global.html#ProtectedLogin">ProtectedLogin</a></li><li><a href="global.html#ProtectedRoute">ProtectedRoute</a></li><li><a href="global.html#recargarUsuarioServer">recargarUsuarioServer</a></li><li><a href="global.html#RecibeCorreos">RecibeCorreos</a></li><li><a href="global.html#Registrar">Registrar</a></li><li><a href="global.html#registrarse">registrarse</a></li><li><a href="global.html#registrarseLocal">registrarseLocal</a></li><li><a href="global.html#Reglas">Reglas</a></li><li><a href="global.html#Routes">Routes</a></li><li><a href="global.html#Sala">Sala</a></li><li><a href="global.html#TabAmigosNotificaciones">TabAmigosNotificaciones</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Mon Apr 05 2021 18:29:05 GMT+0200 (Central European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
